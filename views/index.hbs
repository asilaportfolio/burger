<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
  <meta name="description" content="Mix Burger - O'zbekistondagi eng yaxshi fast food tarmog'i. Lavash, burger, pizza va boshqa mazali taomlar.">
  <meta name="theme-color" content="#513a73">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <title>Mix Burger - Fast Food</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
  <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
  <link rel="stylesheet" href="/index.css">
  <link rel="stylesheet" href="/enhanced-styles.css">
  <link rel="shortcut icon" href="/img/logo.svg">
</head>
<body>

<!-- Professional Loading Screen -->
<div id="loadingScreen" style="position: fixed; top: 0; left: 0; width: 100%; height: 100vh; background: linear-gradient(135deg, #513a73 0%, #764ba2 100%); display: flex; align-items: center; justify-content: center; z-index: 9999; transition: opacity 0.5s ease;">
  <div style="text-align: center;">
    <img src="/img/logo.svg" alt="Logo" style="width: 100px; height: 100px; animation: spin 2s linear infinite;">
    <h3 style="color: white; margin-top: 20px; font-weight: 700; letter-spacing: 2px;">MIX BURGER</h3>
    <div style="width: 150px; height: 4px; background: rgba(255,255,255,0.3); border-radius: 2px; margin: 20px auto; overflow: hidden;">
      <div style="width: 100%; height: 100%; background: linear-gradient(90deg, #ff9900, #ffc107); animation: loading 1.5s ease-in-out infinite;"></div>
    </div>
  </div>
</div>

<style>
@keyframes spin {
  0% { transform: rotate(0deg) scale(1); }
  50% { transform: rotate(180deg) scale(1.1); }
  100% { transform: rotate(360deg) scale(1); }
}
@keyframes loading {
  0% { transform: translateX(-100%); }
  50% { transform: translateX(0); }
  100% { transform: translateX(100%); }
}
</style>

<!-- NAVBAR -->
<nav class="navbar navbara navbar-expand-lg  sticky-top px-4 py-3">
  <div class="container-fluid d-flex justify-content-between align-items-center">

    <!-- Chap tomon -->
    <div class="d-flex align-items-center gap-4">
      <a id="adminLogoAccess" class="navbar-brand d-flex align-items-center" href="#" style="cursor: pointer;">
        <img src="/img/logo.svg" alt="Logo" width="40" height="40" class="me-2">
      </a>
    </div>

<!-- Menu overlay for mobile -->
<div class="menu-overlay" id="menuOverlay"></div>

<div class="d-flex align-items-center gap-4 position-fixed top-0 end-0 m-3" id="navbar-icons">
  <!-- Qo'ng'iroq bloki -->
  <div class="contact-info d-flex flex-column align-items-start justify-content-center ms-3">
    <div class="d-flex align-items-center mb-1">
      <i class='bx bx-phone fs-5 me-2'></i>
      <h5 class="fw-bold mb-0">+998 (90) 123-45-67</h5>
    </div>

    <div class="d-flex align-items-center">
      <i class='bx bx-time-five fs-5 me-2'></i>
      <h5 class="text-muted mb-0">09:00 - 23:00</h5>
    </div>
  </div>

  <!-- Sevimlilar -->
  <button id="favoritesToggleBtn" class="btn btn-outline-dark rounded-circle d-flex align-items-center justify-content-center position-relative" style="width:45px; height:45px;">
    <i class='bx bx-heart fs-4'></i>
    <span id="favoritesBadge" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger" style="display: none; font-size: 10px;">0</span>
  </button>

  <!-- Savatcha -->
  <button id="cartToggleBtn" class="btn btn-outline-dark rounded-circle d-flex align-items-center justify-content-center position-relative" style="width:45px; height:45px;">
    <i class='bx bx-cart fs-4'></i>
    <span id="cartBadge" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger" style="display: none; font-size: 10px;">0</span>
  </button>

  <!-- Dark mode -->
  <button id="themeToggle" class="btn btn-outline-dark rounded-circle d-flex align-items-center justify-content-center" style="width:45px; height:45px;">
    <i id="themeIcon" class="bx bx-moon fs-4"></i>
  </button>

  <!-- Admin panel link (only visible to admins) -->
  {{#if isAdmin}}
  <a href="/admin-panel" class="btn btn-outline-primary rounded-circle d-flex align-items-center justify-content-center" style="width:45px; height:45px;" title="Admin panel">
    <i class='bx bx-cog fs-4'></i>
  </a>
  {{/if}}

</div>

</nav>

 <div class="container-fluid mt-4 main-content" style="flex: 1; min-height: calc(100vh - 200px);">
  <div class="row">
    {{#unless products}}
    <div class="col-12">
      <div class="alert alert-info text-center" role="alert">
        <h4>Tez orada yangi mahsulotlar qo'shiladi...</h4>
        <p>Hozirda mahsulotlar mavjud emas. Iltimos, keyinroq qaytib ko'ring.</p>
      </div>
    </div>
    {{/unless}}

    <div class="col-md-3">
        <div class="nav flex-column nav-pills sticky-top" id="menu-tab" role="tablist" aria-orientation="vertical" style="top: 100px;">
          <a class="nav-linka fw-bold fs-5 active" href="#lavash" data-category="lavash">Lavash</a>
          <a class="nav-link fw-bold fs-5" href="#burger" data-category="burger">Burger</a>
          <a class="nav-link fw-bold fs-5" href="#pizza" data-category="pizza">Pizza</a>
          <a class="nav-link fw-bold fs-5" href="#hotdog" data-category="hotdog">Hotdog</a>
          <a class="nav-link fw-bold fs-5" href="#sandwich" data-category="sandwich">Sandwich</a>
          <a class="nav-link fw-bold fs-5" href="#chips" data-category="chips">Chips</a>
          <a class="nav-link fw-bold fs-5" href="#sous" data-category="sous">Sous</a>
          <a class="nav-link fw-bold fs-5" href="#mix" data-category="mix">Mix</a>
          <a class="nav-link fw-bold fs-5" href="#cake" data-category="cake">Cake</a>
          <a class="nav-link fw-bold fs-5" href="#drinks" data-category="drinks">Drinks</a>
        </div>
    </div>

    <div class="col-md-9">
      <!-- Lavash Category -->
      <div id="lavash" class="category-section" data-category="lavash">
        <h2 class="text-center mb-4">Lavash</h2>
        <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
          {{#each categories}}
            {{#if (eq this.name 'lavash')}}
              {{#each this.products}}
              <div class="col" data-product-id="{{this._id}}">
                <div class="card h-100">
                  <img src="{{this.image}}" class="card-img-top" alt="{{this.name}}" style="height: 200px; object-fit: cover;">
                  <button class="btn-heart">
                    <i class="bx bx-heart"></i>
                  </button>
                  <div class="card-body">
                    <h5 class="card-title fw-bold fs-5">{{this.name}}</h5>
                    <p class="card-text fw-bold">{{this.price}} so'm</p>
                    <button class="btn btn-outline-success add-btn w-100">+ Add</button>
                  </div>
                </div>
              </div>
              {{/each}}
            {{/if}}
          {{/each}}
        </div>
      </div>

      <!-- Burger Category -->
      <div id="burger" class="category-section" data-category="burger">
        <h2 class="text-center mb-4">Burger</h2>
        <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
          {{#each categories}}
            {{#if (eq this.name 'burger')}}
              {{#each this.products}}
              <div class="col" data-product-id="{{this._id}}">
                <div class="card h-100">
                  <img src="{{this.image}}" class="card-img-top" alt="{{this.name}}" style="height: 200px; object-fit: cover;">
                  <button class="btn-heart">
                    <i class="bx bx-heart"></i>
                  </button>
                  <div class="card-body">
                    <h5 class="card-title fw-bold fs-5">{{this.name}}</h5>
                    <p class="card-text fw-bold">{{this.price}} so'm</p>
                    <button class="btn btn-outline-success add-btn w-100">+ Add</button>
                  </div>
                </div>
              </div>
              {{/each}}
            {{/if}}
          {{/each}}
        </div>
      </div>

      <!-- Pizza Category -->
      <div id="pizza" class="category-section" data-category="pizza">
        <h2 class="text-center mb-4">Pizza</h2>
        <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
          {{#each categories}}
            {{#if (eq this.name 'pizza')}}
              {{#each this.products}}
              <div class="col" data-product-id="{{this._id}}">
                <div class="card h-100">
                  <img src="{{this.image}}" class="card-img-top" alt="{{this.name}}" style="height: 200px; object-fit: cover;">
                  <button class="btn-heart">
                    <i class="bx bx-heart"></i>
                  </button>
                  <div class="card-body">
                    <h5 class="card-title fw-bold fs-5">{{this.name}}</h5>
                    <p class="card-text fw-bold">{{this.price}} so'm</p>
                    <button class="btn btn-outline-success add-btn w-100">+ Add</button>
                  </div>
                </div>
              </div>
              {{/each}}
            {{/if}}
          {{/each}}
        </div>
      </div>

      <!-- Hotdog Category -->
      <div id="hotdog" class="category-section" data-category="hotdog">
        <h2 class="text-center mb-4">Hotdog</h2>
        <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
          {{#each categories}}
            {{#if (eq this.name 'hotdog')}}
              {{#each this.products}}
              <div class="col" data-product-id="{{this._id}}">
                <div class="card h-100">
                  <img src="{{this.image}}" class="card-img-top" alt="{{this.name}}" style="height: 200px; object-fit: cover;">
                  <button class="btn-heart">
                    <i class="bx bx-heart"></i>
                  </button>
                  <div class="card-body">
                    <h5 class="card-title fw-bold fs-5">{{this.name}}</h5>
                    <p class="card-text fw-bold">{{this.price}} so'm</p>
                    <button class="btn btn-outline-success add-btn w-100">+ Add</button>
                  </div>
                </div>
              </div>
              {{/each}}
            {{/if}}
          {{/each}}
        </div>
      </div>

      <!-- Sandwich Category -->
      <div id="sandwich" class="category-section" data-category="sandwich">
        <h2 class="text-center mb-4">Sandwich</h2>
        <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
          {{#each categories}}
            {{#if (eq this.name 'sandwich')}}
              {{#each this.products}}
              <div class="col" data-product-id="{{this._id}}">
                <div class="card h-100">
                  <img src="{{this.image}}" class="card-img-top" alt="{{this.name}}" style="height: 200px; object-fit: cover;">
                  <button class="btn-heart">
                    <i class="bx bx-heart"></i>
                  </button>
                  <div class="card-body">
                    <h5 class="card-title fw-bold fs-5">{{this.name}}</h5>
                    <p class="card-text fw-bold">{{this.price}} so'm</p>
                    <button class="btn btn-outline-success add-btn w-100">+ Add</button>
                  </div>
                </div>
              </div>
              {{/each}}
            {{/if}}
          {{/each}}
        </div>
      </div>

      <!-- Chips Category -->
      <div id="chips" class="category-section" data-category="chips">
        <h2 class="text-center mb-4">Chips</h2>
        <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
          {{#each categories}}
            {{#if (eq this.name 'chips')}}
              {{#each this.products}}
              <div class="col" data-product-id="{{this._id}}">
                <div class="card h-100">
                  <img src="{{this.image}}" class="card-img-top" alt="{{this.name}}" style="height: 200px; object-fit: cover;">
                  <button class="btn-heart">
                    <i class="bx bx-heart"></i>
                  </button>
                  <div class="card-body">
                    <h5 class="card-title fw-bold fs-5">{{this.name}}</h5>
                    <p class="card-text fw-bold">{{this.price}} so'm</p>
                    <button class="btn btn-outline-success add-btn w-100">+ Add</button>
                  </div>
                </div>
              </div>
              {{/each}}
            {{/if}}
          {{/each}}
        </div>
      </div>

      <!-- Sous Category -->
      <div id="sous" class="category-section" data-category="sous">
        <h2 class="text-center mb-4">Sous</h2>
        <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
          {{#each categories}}
            {{#if (eq this.name 'sous')}}
              {{#each this.products}}
              <div class="col" data-product-id="{{this._id}}">
                <div class="card h-100">
                  <img src="{{this.image}}" class="card-img-top" alt="{{this.name}}" style="height: 200px; object-fit: cover;">
                  <button class="btn-heart">
                    <i class="bx bx-heart"></i>
                  </button>
                  <div class="card-body">
                    <h5 class="card-title fw-bold fs-5">{{this.name}}</h5>
                    <p class="card-text fw-bold">{{this.price}} so'm</p>
                    <button class="btn btn-outline-success add-btn w-100">+ Add</button>
                  </div>
                </div>
              </div>
              {{/each}}
            {{/if}}
          {{/each}}
        </div>
      </div>

      <!-- Mix Category -->
      <div id="mix" class="category-section" data-category="mix">
        <h2 class="text-center mb-4">Mix</h2>
        <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
          {{#each categories}}
            {{#if (eq this.name 'mix')}}
              {{#each this.products}}
              <div class="col" data-product-id="{{this._id}}">
                <div class="card h-100">
                  <img src="{{this.image}}" class="card-img-top" alt="{{this.name}}" style="height: 200px; object-fit: cover;">
                  <button class="btn-heart">
                    <i class="bx bx-heart"></i>
                  </button>
                  <div class="card-body">
                    <h5 class="card-title fw-bold fs-5">{{this.name}}</h5>
                    <p class="card-text fw-bold">{{this.price}} so'm</p>
                    <button class="btn btn-outline-success add-btn w-100">+ Add</button>
                  </div>
                </div>
              </div>
              {{/each}}
            {{/if}}
          {{/each}}
        </div>
      </div>

      <!-- Cake Category -->
      <div id="cake" class="category-section" data-category="cake">
        <h2 class="text-center mb-4">Cake</h2>
        <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
          {{#each categories}}
            {{#if (eq this.name 'cake')}}
              {{#each this.products}}
              <div class="col" data-product-id="{{this._id}}">
                <div class="card h-100">
                  <img src="{{this.image}}" class="card-img-top" alt="{{this.name}}" style="height: 200px; object-fit: cover;">
                  <button class="btn-heart">
                    <i class="bx bx-heart"></i>
                  </button>
                  <div class="card-body">
                    <h5 class="card-title fw-bold fs-5">{{this.name}}</h5>
                    <p class="card-text fw-bold">{{this.price}} so'm</p>
                    <button class="btn btn-outline-success add-btn w-100">+ Add</button>
                  </div>
                </div>
              </div>
              {{/each}}
            {{/if}}
          {{/each}}
        </div>
      </div>

      <!-- Drinks Category -->
      <div id="drinks" class="category-section" data-category="drinks">
        <h2 class="text-center mb-4">Drinks</h2>
        <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
          {{#each categories}}
            {{#if (eq this.name 'drinks')}}
              {{#each this.products}}
              <div class="col" data-product-id="{{this._id}}">
                <div class="card h-100">
                  <img src="{{this.image}}" class="card-img-top" alt="{{this.name}}" style="height: 200px; object-fit: cover;">
                  <button class="btn-heart">
                    <i class="bx bx-heart"></i>
                  </button>
                  <div class="card-body">
                    <h5 class="card-title fw-bold fs-5">{{this.name}}</h5>
                    <p class="card-text fw-bold">{{this.price}} so'm</p>
                    <button class="btn btn-outline-success add-btn w-100">+ Add</button>
                  </div>
                </div>
              </div>
              {{/each}}
            {{/if}}
          {{/each}}
        </div>
      </div>
    </div>

<footer class="footer-section text-dark pt-5 pb-3 mt-5">
  <div class="footer-container">
    <div class="row">
      <!-- 1. Logo va tavsif -->
      <div class="col-md-4 mb-4">
        <div class="footer-logo">
          <img src="/img/logo.svg" alt="MixBurger Logo" class="footer-logo-img" />
        </div>
        <p class="footer-text mt-3">
          <strong>Mix Burger</strong> â€” O'zbekistondagi mashhur fast food tarmog'i.
          Har bir mehmon uchun qulay muhit, mazali taomlar va zamonaviy xizmat!
        </p>
        <div class="app-links mt-3">
          <a href="#"><img src="/img/512x512.png" alt="App Store" class="store-icon"></a>
          <a href="#"><img src="/img/ios.png" alt="Google Play" class="store-icon"></a>
        </div>
      </div>

      <!-- 2. Kompaniya haqida -->
      <div class="col-md-2 mb-4">
        <h5 class="footer-title">Kompaniya</h5>
        <ul class="list-unstyled">
          <li><a href="#" class="footer-link">Biz haqimizda</a></li>
          <li><a href="#" class="footer-link">Menyu</a></li>
          <li><a href="#" class="footer-link">Aksiya</a></li>
          <li><a href="#" class="footer-link">Filiallar</a></li>
          <li><a href="#" class="footer-link">Vakansiyalar</a></li>
          <li><a href="#" class="footer-link">Kontaktlar</a></li>
        </ul>
      </div>

      <!-- 3. Maâ€™lumotlar -->
      <div class="col-md-3 mb-4">
        <h5 class="footer-title">Ma'lumotlar</h5>
        <ul class="list-unstyled">
          <li><a href="#" class="footer-link">Yetkazib berish</a></li>
          <li><a href="#" class="footer-link">Tolov usullari</a></li>
          <li><a href="#" class="footer-link">Maxfiylik siyosati</a></li>
          <li><a href="#" class="footer-link">Ommaviy oferta</a></li>
        </ul>
      </div>

      <!-- 4. Aloqa va ijtimoiy tarmoqlar -->
      <div class="col-md-3 mb-4">
        <h5 class="footer-title">Aloqa</h5>
        <p class="footer-contact"><strong>Telefon:</strong> +998 78 888 04 04</p>
        <p class="footer-contact"><strong>Email:</strong> info@mixburger.uz</p>

        <div class="social-links mt-3 d-flex gap-3">
          <a href="https://www.facebook.com/" target="_blank" rel="noopener" class="social-icon" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
          <a href="https://www.instagram.com/" target="_blank" rel="noopener" class="social-icon" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
          <a href="https://t.me/" target="_blank" rel="noopener" class="social-icon" aria-label="Telegram"><i class="fab fa-telegram-plane"></i></a>
        </div>
      </div>
    </div>

    <div class="text-center mt-4 pt-3 border-top border-secondary">
      <p class="mb-0 text-secondary">
        Â© 2025 <span>Mix Burger</span>. Barcha huquqlar himoya qilingan.
      </p>
    </div>
  </div>
</footer>


      
      <div class="modal fade" id="favModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-sm">
      <div class="modal-content" style="border: 3px solid green; background-color: #E8FAF0;">
        <div class="modal-body text-center" style="color: #44f18f;">
          ðŸ’š Mahsulot sevimlilar safiga qo'shildi! ðŸ’š
        </div>
      </div>
    </div>
    </div>

<!-- Toast Xabar -->
<div class="toast-container position-fixed bottom-0 end-0 p-3">
  <div id="addToast" class="toast align-items-center text-bg-success border-0" role="alert" aria-live="assertive" aria-atomic="true">
    <div class="d-flex">
      <div class="toast-body">Mahsulot savatchaga qo'shildi!</div>
      <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
    </div>
  </div>

  <div id="orderToast" class="toast align-items-center text-bg-primary border-0" role="alert" aria-live="assertive" aria-atomic="true">
    <div class="d-flex">
      <div class="toast-body">Buyurtma yuborilmoqda...</div>
      <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
    </div>
  </div>
</div>

<div id="cartPanel" class="cart-panel">
  <div class="cart-header d-flex justify-content-between align-items-center">
    <h5 class="m-0">Savatcha</h5>
    <button id="closeCart" class="btn-close"></button>
  </div>
  <ul id="cartItems" class="list-group mt-3 mb-3"></ul>
  <div class="d-flex justify-content-between px-3">
    <strong>Jami:</strong>
    <span id="cartTotal">0</span>
  </div>
  <div class="p-3">
    <form id="orderForm">
      <input id="name" type="text" class="form-control mb-2" placeholder="Ism" required>
      <input id="phone" type="tel" class="form-control mb-2" placeholder="Telefon" required>
      <input id="region" type="text" class="form-control mb-3" placeholder="Viloyat" required>
      <button type="submit" class="btn btn-dark w-100">Buyurtma berish</button>
      <button id="clearCartBtn" type="button" class="btn btn-outline-secondary w-100 mt-2">Savatchani tozalash</button>
    </form>
  </div>
</div>

<!-- Favorites Panel -->
<div id="favoritesPanel" class="cart-panel">
  <div class="cart-header d-flex justify-content-between align-items-center">
    <h5 class="m-0">Sevimlilar</h5>
    <button id="closeFavorites" class="btn-close"></button>
  </div>
  <div id="favoritesItems" class="p-3">
    <!-- Favorites will be rendered here -->
  </div>
</div>

<!-- Admin Product Detail Modal -->
<div class="modal fade" id="adminDetailModal" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Mahsulot ma'lumotlari</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body text-center">
        <img id="detailImage" src="" alt="" class="img-fluid rounded mb-3" style="max-height: 200px;">
        <h4 id="detailName"></h4>
        <p class="text-muted">Kategoriya: <span id="detailCategory" class="badge bg-primary"></span></p>
        <h5 class="text-success">Narxi: <span id="detailPrice"></span> so'm</h5>
        <p class="text-muted">ID: <span id="detailId" style="font-size: 0.8em;"></span></p>
      </div>
    </div>
  </div>
</div>

<!-- Admin Product Edit Modal -->
<div class="modal fade" id="adminEditModal" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Mahsulotni tahrirlash</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <form id="adminEditForm">
          <input type="hidden" id="editProductId">
          <div class="mb-3">
            <label class="form-label">Mahsulot nomi</label>
            <input type="text" id="editProductName" class="form-control" required>
          </div>
          <div class="mb-3">
            <label class="form-label">Narxi (so'm)</label>
            <input type="number" id="editProductPrice" class="form-control" min="0" required>
          </div>
          <div class="mb-3">
            <label class="form-label">Rasm URL</label>
            <input type="url" id="editProductImage" class="form-control" required>
          </div>
          <div class="mb-3">
            <label class="form-label">Kategoriya</label>
            <select id="editProductCategory" class="form-select" required>
              <option value="lavash">Lavash</option>
              <option value="burger">Burger</option>
              <option value="pizza">Pizza</option>
              <option value="hotdog">Hotdog</option>
              <option value="sandwich">Sandwich</option>
              <option value="chips">Chips</option>
              <option value="sous">Sous</option>
              <option value="mix">Mix</option>
              <option value="cake">Cake</option>
              <option value="drinks">Drinks</option>
            </select>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Bekor qilish</button>
        <button type="button" class="btn btn-success" onclick="saveProductEdit()">Saqlash</button>
      </div>
    </div>
  </div>
</div>

 


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="/index.js"></script>

<script>
// Hide loading screen when page is fully loaded
window.addEventListener('load', function() {
  const loadingScreen = document.getElementById('loadingScreen');
  if (loadingScreen) {
    setTimeout(() => {
      loadingScreen.style.opacity = '0';
      setTimeout(() => {
        loadingScreen.style.display = 'none';
      }, 500);
    }, 800);
  }
});

// Fallback: hide after 3 seconds even if not fully loaded
setTimeout(() => {
  const loadingScreen = document.getElementById('loadingScreen');
  if (loadingScreen && loadingScreen.style.display !== 'none') {
    loadingScreen.style.opacity = '0';
    setTimeout(() => {
      loadingScreen.style.display = 'none';
    }, 500);
  }
}, 3000);
</script>

<script>
// Load products from MongoDB and add to existing cards
document.addEventListener('DOMContentLoaded', async function() {
  // Update badges on page load
  updateCartBadge();
  updateFavoritesBadge();
  
  // Show all categories initially
  const categories = document.querySelectorAll('.category-section');
  categories.forEach(category => {
    category.style.display = 'block';
    // Ensure each category has enough height for proper scrolling
    category.style.minHeight = '100vh';
  });
  
  // Add scroll event listener for automatic category switching
  const menuLinks = document.querySelectorAll('#menu-tab a');
  
  // Function to update active category based on scroll
  function updateActiveCategory() {
    const scrollPosition = window.scrollY + window.innerHeight / 3; // Use 1/3 of viewport height for better detection
    let activeCategory = null;
    
    // Find the category that is currently in view
    for (let i = 0; i < categories.length; i++) {
      const category = categories[i];
      const categoryTop = category.offsetTop;
      const categoryBottom = categoryTop + category.offsetHeight;
      
      // Check if we're in this category (with some overlap tolerance)
      if (scrollPosition >= categoryTop && scrollPosition < categoryBottom) {
        activeCategory = category.getAttribute('id');
        break; // Found the active category, exit loop
      }
    }
    
    // If no category is active, find the closest one
    if (!activeCategory && categories.length > 0) {
      const distances = Array.from(categories).map(category => {
        const categoryTop = category.offsetTop;
        return Math.abs(scrollPosition - categoryTop);
      });
      
      const minDistance = Math.min(...distances);
      const closestIndex = distances.indexOf(minDistance);
      activeCategory = categories[closestIndex].getAttribute('id');
    }
    
    if (activeCategory) {
      // Update menu active state
      menuLinks.forEach(link => {
        if (link.getAttribute('href').substring(1) === activeCategory) {
          link.classList.add('active');
        } else {
          link.classList.remove('active');
        }
      });
    }
  }
  
  // Listen for scroll events with throttling for performance
  let ticking = false;
  window.addEventListener('scroll', function() {
    if (!ticking) {
      requestAnimationFrame(function() {
        updateActiveCategory();
        ticking = false;
      });
      ticking = true;
    }
  });
  
  // Initial check
  updateActiveCategory();
  
  // Add click event listeners for category navigation
  document.querySelectorAll('#menu-tab a').forEach(link => {
    link.addEventListener('click', function(e) {
      e.preventDefault();
      
      // Update active state
      menuLinks.forEach(l => l.classList.remove('active'));
      this.classList.add('active');
      
      // Scroll to category
      const targetCategory = this.getAttribute('href').substring(1); // Get id from href
      const targetElement = document.getElementById(targetCategory);
      if (targetElement) {
        // Calculate offset to account for fixed navbar and add some padding
        const offsetTop = targetElement.offsetTop - 120;
        window.scrollTo({
          top: offsetTop,
          behavior: 'smooth'
        });
        
        // Update active category after scrolling
        setTimeout(updateActiveCategory, 300);
      }
    });
  });
});  
</script>

<!-- Admin Access via Logo Double-Click -->
<script>
// Double-click logo to access admin panel
const adminLogo = document.getElementById('adminLogoAccess');
if (adminLogo) {
  adminLogo.style.cursor = 'pointer';
  
  // Double-click event listener
  adminLogo.addEventListener('dblclick', function(e) {
    e.preventDefault();
    window.location.href = '/admin-login';
  });
  
  // Visual feedback on single click
  adminLogo.addEventListener('click', function(e) {
    if (e.detail === 1) {
      // Single click - do nothing, just visual feedback
      this.style.transform = 'scale(0.95)';
      setTimeout(() => {
        this.style.transform = 'scale(1)';
      }, 150);
    }
  });
}

// === Telegram sozlamalari ===
const TELEGRAM_TOKEN = "8168566877:AAH2__yRQS_fow7cCqbXxvjy-HW-mtup5-s";
const TELEGRAM_CHAT_ID = "474893071";
const TELEGRAM_API_URL = `https://api.telegram.org/bot${TELEGRAM_TOKEN}/sendMessage`;

// === DOM elementlari ===
const cartPanel = document.getElementById('cartPanel');
const favoritesPanel = document.getElementById('favoritesPanel');
const cartToggleBtn = document.getElementById('cartToggleBtn');
const favoritesToggleBtn = document.getElementById('favoritesToggleBtn');
const closeCartBtn = document.getElementById('closeCart');
const closeFavoritesBtn = document.getElementById('closeFavorites');
const cartItemsEl = document.getElementById('cartItems');
const favoritesItemsEl = document.getElementById('favoritesItems');
const cartTotalEl = document.getElementById('cartTotal');
const orderForm = document.getElementById('orderForm');
const addToastEl = document.getElementById('addToast');
const orderToastEl = document.getElementById('orderToast');
const addToast = addToastEl ? new bootstrap.Toast(addToastEl) : null;
const orderToast = orderToastEl ? new bootstrap.Toast(orderToastEl) : null;
const clearCartBtn = document.getElementById('clearCartBtn');
const heartBtns = document.querySelectorAll('.btn-heart');
const favModalEl = document.getElementById('favModal');
const favModal = favModalEl ? new bootstrap.Modal(favModalEl) : null;
const icon = document.getElementById('themeIcon');
const loginModalEl = document.getElementById('loginModal');
const successModalEl = document.getElementById('successModal');
const loginModal = loginModalEl ? new bootstrap.Modal(loginModalEl) : null;
const successModal = successModalEl ? new bootstrap.Modal(successModalEl) : null;

const STORAGE_KEY = 'mixburger_cart_v1';
const FAVORITES_KEY = 'mixburger_favorites_v1';
let cart = loadCart();
let favorites = loadFavorites();

// === Helper Functions ===
function loadCart() {
  try {
    const data = localStorage.getItem(STORAGE_KEY);
    return data ? JSON.parse(data) : [];
  } catch {
    return [];
  }
}

function saveCart() {
  localStorage.setItem(STORAGE_KEY, JSON.stringify(cart));
  updateCartBadge();
}

function loadFavorites() {
  try {
    const data = localStorage.getItem(FAVORITES_KEY);
    return data ? JSON.parse(data) : [];
  } catch {
    return [];
  }
}

function saveFavorites() {
  localStorage.setItem(FAVORITES_KEY, JSON.stringify(favorites));
  updateFavoritesBadge();
}

function updateCartBadge() {
  const badge = document.getElementById('cartBadge');
  const total = cart.reduce((sum, item) => sum + item.qty, 0);
  if (badge) {
    if (total > 0) {
      badge.textContent = total;
      badge.style.display = 'block';
      // Add bounce animation
      badge.style.animation = 'none';
      setTimeout(() => badge.style.animation = 'badgePulse 0.5s ease', 10);
    } else {
      badge.style.display = 'none';
    }
  }
}

function updateFavoritesBadge() {
  const badge = document.getElementById('favoritesBadge');
  if (badge) {
    if (favorites.length > 0) {
      badge.textContent = favorites.length;
      badge.style.display = 'block';
      // Add bounce animation
      badge.style.animation = 'none';
      setTimeout(() => badge.style.animation = 'badgePulse 0.5s ease', 10);
    } else {
      badge.style.display = 'none';
    }
  }
}

function totalCart() {
  return cart.reduce((sum, item) => sum + item.price * item.qty, 0);
}

function escapeHtml(text) {
  const div = document.createElement('div');
  div.textContent = text;
  return div.innerHTML;
}

// === Savatcha ochish/yopish ===
if (cartToggleBtn && cartPanel) {
  cartToggleBtn.addEventListener('click', () => {
    // Close favorites if open
    if (favoritesPanel) favoritesPanel.classList.remove('open');
    cartPanel.classList.toggle('open');
    renderCart();
  });
}
if (closeCartBtn && cartPanel) closeCartBtn.addEventListener('click', () => cartPanel.classList.remove('open'));

// === Sevimlilar panelini ochish/yopish ===
if (favoritesToggleBtn && favoritesPanel) {
  favoritesToggleBtn.addEventListener('click', () => {
    // Close cart if open
    if (cartPanel) cartPanel.classList.remove('open');
    favoritesPanel.classList.toggle('open');
    renderFavorites();
  });
}
if (closeFavoritesBtn && favoritesPanel) closeFavoritesBtn.addEventListener('click', () => favoritesPanel.classList.remove('open'));

// === Savatchani tozalash ===
if (clearCartBtn) {
  clearCartBtn.addEventListener('click', () => {
    if (!cart.length) return;
    if (!confirm('Haqiqatan ham tozalamoqchimisiz?')) return;
    cart = [];
    saveCart();
    renderCart();
  });
}

// === Mahsulot qo'shish ===
document.addEventListener('click', (e) => {
  // Handle add to cart
  const addBtn = e.target.closest('.add-btn');
  if (addBtn) {
    e.preventDefault();
    const card = addBtn.closest('.card');
    const name = card.querySelector('.card-title')?.textContent?.trim() || 'Mahsulot';
    const priceText = card.querySelector('.card-text')?.textContent?.replace(/[^\d]/g, '') || '0';
    const price = Number(priceText);
    addToCart(name, price);
    return;
  }

  // Handle add to favorites
  const heartBtn = e.target.closest('.btn-heart');
  if (heartBtn) {
    e.preventDefault();
    const card = heartBtn.closest('.card');
    const name = card.querySelector('.card-title')?.textContent?.trim() || 'Mahsulot';
    const image = card.querySelector('img')?.src || '';
    const priceText = card.querySelector('.card-text')?.textContent?.replace(/[^\d]/g, '') || '0';
    const price = Number(priceText);
    
    toggleFavorite({name, image, price}, heartBtn);
  }
});

function toggleFavorite(product, heartBtn) {
  const idx = favorites.findIndex(f => f.name === product.name);
  const heartIcon = heartBtn.querySelector('i');
  
  if (idx >= 0) {
    // Remove from favorites
    favorites.splice(idx, 1);
    heartIcon.classList.remove('bxs-heart');
    heartIcon.classList.add('bx-heart');
    heartBtn.classList.remove('active');
  } else {
    // Add to favorites
    favorites.push(product);
    heartIcon.classList.remove('bx-heart');
    heartIcon.classList.add('bxs-heart');
    heartBtn.classList.add('active');
    
    // Show animation
    heartBtn.style.animation = 'heartBeat 0.5s ease';
    setTimeout(() => heartBtn.style.animation = '', 500);
    
    // Show toast
    if (addToastEl && addToast) {
      document.querySelector('#addToast .toast-body').textContent = `${product.name} sevimlilarga qo'shildi!`;
      addToast.show();
    }
  }
  
  saveFavorites();
}

function addToCart(name, price) {
  const idx = cart.findIndex(i => i.name === name);
  if (idx >= 0) cart[idx].qty++;
  else cart.push({ name, price, qty: 1 });

  saveCart();
  renderCart();

  if (addToastEl && addToast) {
    document.querySelector('#addToast .toast-body').textContent = `${name} savatchaga qo'shildi!`;
    addToast.show();
  }
}

// === Savatchani render qilish ===
function renderCart() {
  cartItemsEl.innerHTML = '';
  if (cart.length === 0) {
    cartItemsEl.innerHTML = '<li class="list-group-item">Savatcha boâ€˜sh</li>';
    cartTotalEl.textContent = '0';
    return;
  }

  cart.forEach((item, index) => {
    const li = document.createElement('li');
    li.className = 'list-group-item d-flex justify-content-between align-items-center';
    li.innerHTML = `
      <div>
        <strong>${escapeHtml(item.name)}</strong><br>
        <small>${Number(item.price).toLocaleString()} so'm</small>
      </div>
      <div class="d-flex align-items-center">
        <button class="qty-btn qty-minus btn btn-sm me-2" data-index="${index}">-</button>
        <span class="mx-2">${item.qty}</span>
        <button class="qty-btn qty-plus btn btn-sm ms-2" data-index="${index}">+</button>
        <button class="btn btn-sm btn-outline-secondary ms-2" data-remove="${index}">âœ–</button>
      </div>
    `;
    cartItemsEl.appendChild(li);
  });

  cartTotalEl.textContent = totalCart().toLocaleString();

  document.querySelectorAll('.qty-plus').forEach(b => b.onclick = () => {
    const i = +b.dataset.index;
    cart[i].qty++;
    saveCart();
    renderCart();
  });

  document.querySelectorAll('.qty-minus').forEach(b => b.onclick = () => {
    const i = +b.dataset.index;
    if (cart[i].qty > 1) cart[i].qty--;
    else cart.splice(i, 1);
    saveCart();
    renderCart();
  });

  document.querySelectorAll('[data-remove]').forEach(b => b.onclick = () => {
    const i = +b.dataset.remove;
    cart.splice(i, 1);
    saveCart();
    renderCart();
  });
}

// === Sevimlilarni render qilish ===
function renderFavorites() {
  if (!favoritesItemsEl) return;
  
  favoritesItemsEl.innerHTML = '';
  
  if (favorites.length === 0) {
    favoritesItemsEl.innerHTML = '<p class="text-center text-muted mt-4">Sevimlilar bo\'sh</p>';
    return;
  }
  
  favorites.forEach((item, index) => {
    const card = document.createElement('div');
    card.className = 'card mb-3';
    card.innerHTML = `
      <div class="row g-0">
        <div class="col-4">
          <img src="${item.image}" class="img-fluid rounded-start" alt="${item.name}" style="height: 100%; object-fit: cover;">
        </div>
        <div class="col-8">
          <div class="card-body">
            <h6 class="card-title">${escapeHtml(item.name)}</h6>
            <p class="card-text mb-2"><small><strong>${Number(item.price).toLocaleString()} so'm</strong></small></p>
            <div class="d-flex gap-2">
              <button class="btn btn-sm btn-outline-success add-to-cart-fav" data-index="${index}">+ Savatchaga</button>
              <button class="btn btn-sm btn-outline-danger remove-fav" data-index="${index}">âœ–</button>
            </div>
          </div>
        </div>
      </div>
    `;
    favoritesItemsEl.appendChild(card);
  });
  
  // Add event listeners after rendering
  document.querySelectorAll('.add-to-cart-fav').forEach(btn => {
    btn.addEventListener('click', function() {
      const index = parseInt(this.getAttribute('data-index'));
      const item = favorites[index];
      if (item) {
        addToCart(item.name, item.price);
      }
    });
  });
  
  document.querySelectorAll('.remove-fav').forEach(btn => {
    btn.addEventListener('click', function() {
      const index = parseInt(this.getAttribute('data-index'));
      const item = favorites[index];
      favorites.splice(index, 1);
      saveFavorites();
      renderFavorites();
      
      // Update heart icon on product card
      const cards = document.querySelectorAll('.card');
      cards.forEach(card => {
        const cardName = card.querySelector('.card-title')?.textContent?.trim();
        if (cardName === item.name) {
          const heartBtn = card.querySelector('.btn-heart');
          if (heartBtn) {
            const heartIcon = heartBtn.querySelector('i');
            heartIcon.classList.remove('bxs-heart');
            heartIcon.classList.add('bx-heart');
            heartBtn.classList.remove('active');
          }
        }
      });
    });
  });
}

// === Buyurtmani yuborish (telefon raqami qoâ€˜shilgan) ===
orderForm.addEventListener('submit', async (e) => {
  e.preventDefault();
  if (cart.length === 0) {
    alert(`Savatcha bo'sh!`);
    return;
  }

  const name = document.getElementById('name').value.trim();
  const phone = document.getElementById('phone').value.trim();
  const region = document.getElementById('region').value.trim();
  const surname = document.getElementById('surname')?.value?.trim() || "Ko'rsatilmagan"; // yangi qoâ€˜shimcha

  if (!name || !phone || !region) {
    alert(`Iltimos, barcha maydonlarni to'ldiring.`);
    return;
  }

  let lines = [];
  lines.push('*Yangi buyurtma*', '');
  lines.push(`ðŸ‘¤ Ism: ${name}`);
  lines.push(`ðŸ“ž Telefon: ${phone}`);
  lines.push(`ðŸ“ Viloyat: ${region}`, '', 'ðŸ” Mahsulotlar:');
  cart.forEach(it => lines.push(`â€¢ ${it.name} â€” ${it.qty} dona (${it.price.toLocaleString()} so'm)`));
  lines.push('', `ðŸ’° Jami: ${totalCart().toLocaleString()} so'm`);
  const messageText = lines.join('\n');

  try {
    const res = await fetch(TELEGRAM_API_URL, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        chat_id: TELEGRAM_CHAT_ID,
        text: messageText,
        parse_mode: 'Markdown'
      })
    });
    const data = await res.json();
    if (data.ok) {
      alert('Buyurtma muvaffaqiyatli yuborildi');
      cart = [];
      saveCart();
      renderCart();
      orderForm.reset();
    } else {
      alert('Xatolik: buyurtma yuborilmadi ');
    }
  } catch (err) {
    alert('Tarmoq xatosi: internetni tekshiring ');
  }
});
// === RESPONSIVE MENU ===
const menuTab = document.getElementById('menu-tab');
const menuOverlay = document.getElementById('menuOverlay');
const navbarIcons = document.getElementById('navbar-icons');

// Agar toggle hali yaratilmagan bo'lsa â€” yaratamiz
let toggleBtn = document.getElementById('menuToggle');
if (!toggleBtn) {
  const navbar = document.querySelector('.navbara');
  toggleBtn = document.createElement('button');
  toggleBtn.id = 'menuToggle';
  toggleBtn.innerHTML = '<i class="bx bx-menu"></i>';
  toggleBtn.setAttribute('aria-label', 'Menu');
  navbar.prepend(toggleBtn);
}

// Tugmaga bosilganda menyu ochiladi/yopiladi
toggleBtn.addEventListener('click', () => {
  menuTab.classList.toggle('open');
  if (menuOverlay) {
    menuOverlay.classList.toggle('active');
  }
});

// Overlay bosilganda menyu yopiladi
if (menuOverlay) {
  menuOverlay.addEventListener('click', () => {
    menuTab.classList.remove('open');
    menuOverlay.classList.remove('active');
  });
}

// Menyudagi link bosilganda menyu yopiladi
document.querySelectorAll('#menu-tab a').forEach(link => {
  link.addEventListener('click', () => {
    menuTab.classList.remove('open');
    if (menuOverlay) {
      menuOverlay.classList.remove('active');
    }
  });
});

// Helper function for Handlebars
function eq(a, b) {
  return a === b;
}

// Admin-related UI controls have been removed from the home page to keep CRUD hidden.
